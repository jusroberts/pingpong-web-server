// # Place all the behaviors and hooks related to the matching controller here.
// # All this logic will automatically be available in application.js.
// # You can use CoffeeScript in this file: http://coffeescript.org/
$(function() {
  var roomId = $('#room-id').text();
  var dispatcher = new WebSocketRails(window.location.host + '/websocket');
  channel = dispatcher.subscribe('room' + roomId);
  console.log(window.location.host + '/websocket');
  console.log('room' + roomId);
  channel.bind('team_a_score', function(score) {
    if (score === 'W') {
      $("#team_a_status").text("WINNER!");
    } else {
      $("#team_a_status").text('\xa0');
    }
    $("#team_a_score").text(score);
    console.log(score);
  });
  channel.bind('team_b_score', function(score) {
    if (score === 'W') {
      $("#team_b_status").text("WINNER!");
    } else {
      $("#team_b_status").text('\xa0');
    }
    $("#team_b_score").text(score);
    console.log(score);
  });
});

$(function() {
  var background = "url(\"/images/match_backgrounds/bg_";
  background += Math.floor(Math.random() * 121) + 1;
  background += ".gif\")";
  background += " no-repeat center center fixed";
  $(".rooms.show").css({
    "background": background,
    "-webkit-background-size": "cover", /* For WebKit*/
    "-moz-background-size": "cover",    /* Mozilla*/
    "-o-background-size": "cover",      /* Opera*/
    "background-size": "cover"         /* Generic*/
  });
});
